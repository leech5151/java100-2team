<meta charset="UTF-8">
<link href="../../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
<link href="../../css/main.css" rel="stylesheet">
<link href="../../css/together.css" rel="stylesheet">
<link href="../../css/together2.css" rel="stylesheet">
<header style="text-align: center;">
<h2>PET TOGETHER</h2>
</header>
<div class="form-group row" style="text-align: right;">
<div class="col-sm-10">
    <select id='category' class="btn btn-secondary data-reset" name="category">
    <option value=카테고리>카테고리</option>
    <option value=숙박업소>숙박업소</option>
    <option value=식당>식당</option>
    <option value=기타>기타</option>
    </select>
</div>
</div>
<div class="bal-mb-3" style="margin-top:-60px;">
	<div style="margin-top: 8%;">
	<div class="bal-mb-3-list">
	</div>
	</div> 
</div> 
<footer>
	<nav aria-label="Page navigation">
		<ul class="pagination justify-content-center">
			<li class="page-item"><a id="prevBtn" class="page-link"
				tabindex="-1">이전</a></li>

			<li class="page-item"><a id="currBtn" class="page-link" href="#">1</a></li>

			<li class="page-item "><a id="nextBtn" class="page-link"
				tabindex="0">다음</a></li>
		</ul>
	</nav>
</footer>
  <!-- <a href="../business/form.html?no={{businessNo}}"></a> -->
<script src='../../node_modules/handlebars/dist/handlebars.min.js'></script>
<script src='../../node_modules/jquery/dist/jquery.js'></script>
<script src='../../node_modules/bootstrap/dist/js/bootstrap.min.js'></script>
<script src="../../js/together.js"></script>
<script src="../../js/together2.js"></script>
<script id="template" type="text/x-handlebars-template">

{{#each list}}
    <div class="bal-mb-3-data" style="width:300px; height:250px;">
		<figure class="snip1132">
        {{#each files}}
            {{#if @first}}
                 <img src="../../download/{{filename}}" alt="{{filename}}" style="width:100%; height:100%;">
            {{/if}}
        {{/each}}
	<figcaption>
    	<div class="heading">
     		<h3>{{primary_address}}<span>{{businessName}}</span></h3>
    	</div>
    	<div class="caption">
      		<p>{{category}}</p>
    	</div>
  	</figcaption>
  	<a href="../business/form.html?no={{businessNo}}"></a>
	</figure>
    </div>
{{/each}}
</script>
<script type="text/javascript">
/* words = $('#words'),
searchBtn = $('#searchBtn'), */
var prevBtn = $('#prevBtn'),
currBtn = $('#currBtn'),
nextBtn = $('#nextBtn'),
blistItem = $('.bal-mb-3-list'),
currPageNo = 1;
templateSrc = $('#template').html(),
templateEngine = Handlebars.compile(templateSrc);
load(1);


/* searchBtn.click(() => {
//event.preventDefault();
load(1, {
    "words": words.value
})
}); */

prevBtn.click(() => {
load(currPageNo - 1)
});

nextBtn.click(() => {
load(currPageNo + 1)
});


function load(pageNo, options) {

if (options == undefined) options = {};
options.pn = pageNo;

var count;
$.ajax('../../json/business/list', {
    /*method: 'GET',*/
    data: options,
    dataType: 'json',  
    success: (result) => {
        for (var item of result.list) {
            for (var files of item.files) {
                files.businessName = item.businessName;
            }
        }
        console.log(result);
        blistItem.html(templateEngine(result));
        
        currPageNo = result.pageNo;
        currBtn.html(currPageNo);
        
        if (result.pageNo == 1) {
            $(prevBtn.parent()).addClass("disabled");
        } else {
            $(prevBtn.parent()).removeClass("disabled");
        }
        
        if (result.lastPageNo == result.pageNo) {
            $(nextBtn.parent()).addClass("disabled");
        } else {
            $(nextBtn.parent()).removeClass("disabled");
        }
    },
    error: () => {
        window.alert('error! blist');
    }
});
}


</script>
<script src="../../together-list/javascript/demo.js"></script>
					  